From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Softik Lord <dimap9986@gmail.com>
Date: Fri, 15 Jul 2022 03:25:31 +0500
Subject: [PATCH] Fix-AssertionError-when-player-hand-set-to-empty-typ

Fixes an AssertionError when setting the player's item in hand to null or a new ItemStack of Air in PlayerInteractEvent
Fixes GH-2718

diff --git a/src/main/java/net/minecraft/server/PlayerConnection.java b/src/main/java/net/minecraft/server/PlayerConnection.java
index a27629256dc6037bfa7bcf8c1ae437d1917d9765..e0ede414d2e5fd63e3b1ffba8e014cd1495aaf7e 100644
--- a/src/main/java/net/minecraft/server/PlayerConnection.java
+++ b/src/main/java/net/minecraft/server/PlayerConnection.java
@@ -1093,6 +1093,10 @@ public class PlayerConnection implements PacketListenerPlayIn, ITickable {
             if (cancelled) {
                 com.github.ruviolence.reaper.InventoryUpdateHelper.onRightClick(this.player, enumhand, itemstack); // SPIGOT-2524 // Reaper - Reduce inventory updates
             } else {
+                // Reaper start
+                itemstack = this.player.getItemInHand(enumhand);
+                if (itemstack.isEmpty()) return;
+                // Reaper end
                 this.player.playerInteractManager.a(this.player, worldserver, itemstack, enumhand);
             }
             // CraftBukkit end
